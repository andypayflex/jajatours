---
phase: 03-tour-content
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - src/pages/inquiry.astro
  - src/pages/inquiry-success.astro
  - src/components/InquiryForm.astro
autonomous: true

must_haves:
  truths:
    - "Visitor can fill out a custom trip inquiry form with name, email, tour interest, group size, preferred dates, and message"
    - "Form submits to Netlify Forms with honeypot spam prevention"
    - "Visitor sees a confirmation page after successful form submission"
    - "Tour interest dropdown is populated from Sanity tour data at build time"
  artifacts:
    - path: "src/pages/inquiry.astro"
      provides: "Custom trip inquiry page with form"
      contains: "InquiryForm"
      min_lines: 20
    - path: "src/pages/inquiry-success.astro"
      provides: "Form submission confirmation page"
      contains: "Thank"
      min_lines: 15
    - path: "src/components/InquiryForm.astro"
      provides: "Netlify-compatible form with honeypot, hidden form-name field"
      contains: "netlify"
      min_lines: 50
  key_links:
    - from: "src/components/InquiryForm.astro"
      to: "Netlify Forms"
      via: "netlify attribute and hidden form-name field"
      pattern: "form-name.*custom-trip-inquiry"
    - from: "src/components/InquiryForm.astro"
      to: "src/sanity/lib/queries.ts"
      via: "fetch allToursQuery for tour dropdown options"
      pattern: "allToursQuery"
    - from: "src/components/InquiryForm.astro"
      to: "src/pages/inquiry-success.astro"
      via: "form action attribute"
      pattern: "action.*inquiry-success"
---

<objective>
Build the custom trip inquiry form and success page so visitors can request private/custom tours.

Purpose: This satisfies TOUR-06 (custom/private trip inquiry). The form captures visitor details and tour interest, submits via Netlify Forms (zero backend), and shows a confirmation. This is independent of tour detail pages and can be built in parallel.

Output: /inquiry page with Netlify-compatible form, /inquiry-success confirmation page, reusable InquiryForm component.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-tour-content/03-RESEARCH.md
@src/sanity/lib/queries.ts
@src/sanity/lib/client.ts
@src/layouts/BaseLayout.astro
@src/styles/global.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create InquiryForm component with Netlify Forms integration</name>
  <files>src/components/InquiryForm.astro</files>
  <action>
Create the inquiry form component that integrates with Netlify Forms.

**Props interface:**
```typescript
interface Props {
  tours: Array<{ slug: string; title: string }>;
  preselectedTour?: string;
}
```

**Form implementation:**
- Form element with attributes: `name="custom-trip-inquiry"`, `method="POST"`, `action="/inquiry-success"`, `netlify`, `netlify-honeypot="bot-field"`
- Hidden honeypot field: `<p class="hidden"><label>Don't fill this out: <input name="bot-field" /></label></p>` with `.hidden { position: absolute; left: -9999px; }`
- CRITICAL: Hidden form-name field: `<input type="hidden" name="form-name" value="custom-trip-inquiry" />` -- Netlify bots need this for Astro-rendered forms (Pitfall 1 from research)
- Fields:
  1. **Name** (text, required) -- label "Full Name", name="name"
  2. **Email** (email, required) -- label "Email Address", name="email"
  3. **Phone** (tel, optional) -- label "Phone Number (optional)", name="phone"
  4. **Tour Interest** (select, optional) -- label "Tour Interest", name="tour". Options: empty default "Select a tour..." + one option per tour from props. If preselectedTour prop given, set it as `selected`.
  5. **Group Size** (number, optional, min 1, max 20) -- label "Group Size", name="groupSize"
  6. **Preferred Dates** (text, optional) -- label "Preferred Dates", name="dates", placeholder "e.g. June 2026 or flexible"
  7. **Message** (textarea, 5 rows, optional) -- label "Tell us about your ideal trip", name="message"
- Submit button: "Send Inquiry", full width on mobile

**Styling (scoped):**
- Form layout: flex column, gap 1.5rem
- Labels: display block, font-weight 600, margin-bottom 0.25rem, font-size 0.875rem
- Required indicator: `<span class="required" aria-label="required">*</span>` in red
- Inputs/selects/textarea: width 100%, padding 0.75rem, border 1px solid var(--color-text-light) at 30% opacity, border-radius 4px, font-family inherit, font-size 1rem, min-height 44px (touch target)
- Input focus: border-color var(--color-primary), outline none, box-shadow 0 0 0 2px var(--color-primary) at 20% opacity
- Submit button: uses global button styles (already defined in global.css), width 100% on mobile, max-width 300px on desktop, font-size 1.1rem, padding 1rem 2rem
  </action>
  <verify>
Run `npm run build` to confirm no TypeScript errors. Verify the file contains both `netlify` attribute and hidden `form-name` input.
  </verify>
  <done>
InquiryForm.astro renders a complete Netlify-compatible form with honeypot spam prevention, hidden form-name field, tour dropdown populated from props, and all required inquiry fields. Accessible with proper labels and 44px touch targets.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create inquiry page and success page</name>
  <files>src/pages/inquiry.astro, src/pages/inquiry-success.astro</files>
  <action>
**inquiry.astro:**
1. Import BaseLayout, InquiryForm, client, allToursQuery
2. Fetch tours for the dropdown: `const tours = await client.fetch(allToursQuery);`
3. Check for `Astro.url.searchParams.get('tour')` to pre-select a tour if linked from a tour detail page
4. Wrap in BaseLayout with title="Plan Your Trip" and description="Request a custom or private tour with JaJa Tours. Tell us your dream adventure and we'll make it happen."
5. Page structure:
   - `<section class="container inquiry-page">`
   - `<h1>Plan Your Custom Trip</h1>`
   - Intro text: "Want a private or custom tour experience? Tell us about your dream adventure and we'll create a personalized itinerary just for you. We typically respond within 24 hours."
   - Render InquiryForm with tours array and preselectedTour from URL param

**inquiry-success.astro:**
1. Import BaseLayout only (no data fetching needed)
2. Wrap in BaseLayout with title="Inquiry Sent" and description="Your tour inquiry has been sent successfully"
3. Page structure:
   - `<section class="container success-page">`
   - Success icon: A simple checkmark using CSS (green circle with white check via border trick, no SVG needed)
   - `<h1>Thank You!</h1>`
   - `<p>Your inquiry has been received. We'll get back to you within 24 hours with a personalized tour plan.</p>`
   - `<p>In the meantime, feel free to browse our tours or reach out on WhatsApp.</p>`
   - Link back to /tours: `<a href="/tours" class="btn">Browse Tours</a>`

**Styling for inquiry.astro (scoped):**
- `.inquiry-page`: padding-top 2rem, padding-bottom 3rem, max-width 600px within container

**Styling for inquiry-success.astro (scoped):**
- `.success-page`: text-align center, padding-top 3rem, padding-bottom 3rem
- `.checkmark`: width 80px, height 80px, border-radius 50%, background #d4f4dd, margin 0 auto 1.5rem, display flex, align-items center, justify-content center. Inner element styled as checkmark via rotated border.
- `.btn`: styled as primary button (background var(--color-primary), color white, padding 1rem 2rem, border-radius 4px, display inline-flex, text-decoration none, margin-top 1.5rem)
  </action>
  <verify>
Run `npm run build` to confirm both pages build. Check that /inquiry and /inquiry-success routes exist. Verify InquiryForm receives tours data from Sanity.
  </verify>
  <done>
/inquiry page renders InquiryForm with Sanity tour data for dropdown, supports ?tour= pre-selection. /inquiry-success shows confirmation message with link back to tours. Both pages build without errors.
  </done>
</task>

</tasks>

<verification>
1. `npm run build` completes without errors
2. InquiryForm.astro has `netlify` attribute, `netlify-honeypot`, and hidden `form-name` input
3. /inquiry page fetches tours from Sanity for dropdown
4. Form action points to /inquiry-success
5. /inquiry-success page shows thank you message with link to /tours
6. All form inputs have proper labels and 44px minimum touch targets
</verification>

<success_criteria>
- /inquiry page with fully functional Netlify Forms integration
- Form captures: name, email, phone, tour interest, group size, dates, message
- Honeypot spam prevention active
- Tour dropdown populated from Sanity at build time
- ?tour= URL parameter pre-selects tour in dropdown
- /inquiry-success confirmation page shows after submission
- Both pages use BaseLayout and follow established design patterns
</success_criteria>

<output>
After completion, create `.planning/phases/03-tour-content/03-03-SUMMARY.md`
</output>
