---
phase: 03-tour-content
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/pages/tours/index.astro
  - src/components/TourCard.astro
autonomous: true

must_haves:
  truths:
    - "Visitor can browse all published tours on /tours with title, excerpt, image, price, category, and duration"
    - "Tour cards link to individual tour detail pages at /tours/{slug}"
    - "Tour listing is responsive: 1 column mobile, 2 columns tablet, 3 columns desktop"
    - "Tour images use Sanity CDN with optimized URLs via urlForImage helper"
  artifacts:
    - path: "src/pages/tours/index.astro"
      provides: "Tour listing page fetching from Sanity"
      contains: "allToursQuery"
      min_lines: 30
    - path: "src/components/TourCard.astro"
      provides: "Reusable tour card component with image, title, excerpt, pricing, category, duration"
      min_lines: 40
  key_links:
    - from: "src/pages/tours/index.astro"
      to: "src/sanity/lib/queries.ts"
      via: "import and fetch allToursQuery"
      pattern: "allToursQuery"
    - from: "src/pages/tours/index.astro"
      to: "src/components/TourCard.astro"
      via: "import and render for each tour"
      pattern: "TourCard"
    - from: "src/components/TourCard.astro"
      to: "src/sanity/lib/image.ts"
      via: "urlForImage for card images"
      pattern: "urlForImage"
---

<objective>
Build the tour listing page at /tours and a reusable TourCard component that displays all published tours from Sanity.

Purpose: This is the primary entry point for tour browsing. Visitors arriving from the homepage "Our Tours" link (already wired in Navigation.astro to /tours) need to see all available tours with enough info to decide which to explore further.

Output: /tours page with responsive card grid, TourCard component with image, title, excerpt, pricing, category badge, and duration.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@src/sanity/lib/queries.ts
@src/sanity/lib/client.ts
@src/sanity/lib/image.ts
@src/layouts/BaseLayout.astro
@src/styles/global.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create TourCard component</name>
  <files>src/components/TourCard.astro</files>
  <action>
Create a reusable tour card component that receives a tour object as a prop and renders a clickable card.

**Props interface:**
```typescript
interface Props {
  tour: {
    slug: string;
    title: string;
    excerpt?: string;
    mainImage?: {
      asset: { _ref: string };
      alt?: string;
    };
    pricing?: {
      amount: number;
      currency: string;
      perPerson: boolean;
    };
    category?: string;
    duration?: string;
  };
}
```

**Structure:**
- Wrap entire card in `<a href={/tours/${tour.slug}}>` for full-card clickability
- If mainImage exists, render with `urlForImage(tour.mainImage).width(600).height(400).url()` for optimized card images. Alt text from `tour.mainImage.alt || tour.title`.
- Title as `<h2>`
- Excerpt as `<p>` (truncated naturally by CSS if needed)
- Meta row at bottom with:
  - Category badge (styled span)
  - Duration text
  - Price: format as "R{amount} per person" for ZAR, "{currency} {amount}" otherwise. Show "per person" only if `perPerson` is true.

**Styling (scoped):**
- Card with 1px border using `var(--color-text-light)` at 20% opacity, 8px border-radius, overflow hidden
- Hover: subtle box-shadow lift (0 4px 12px rgba(0,0,0,0.1))
- Image: width 100%, height 200px, object-fit cover
- Content padding: 1rem
- Meta row: flex with wrap, gap 0.75rem, font-size 0.875rem
- Category badge: small pill with primary color background at 10% opacity, primary color text, 0.25rem 0.75rem padding, 4px border-radius
- Price: font-weight 700, color var(--color-primary)
- Link: text-decoration none, color inherit (entire card is link)

Import `urlForImage` from `@sanity/lib/image`.
  </action>
  <verify>
Run `npm run build` to confirm no TypeScript errors. Check that TourCard.astro exists and imports urlForImage.
  </verify>
  <done>
TourCard.astro renders a clickable card with optimized Sanity image, title, excerpt, category badge, duration, and formatted price. Scoped styles follow earth tone design system with mobile-friendly 44px+ touch targets.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create tour listing page at /tours</name>
  <files>src/pages/tours/index.astro</files>
  <action>
Create the tour listing page that fetches all tours from Sanity and renders them in a responsive grid.

**Implementation:**
1. Import BaseLayout, TourCard, client, and allToursQuery
2. Fetch tours: `const tours = await client.fetch(allToursQuery);`
3. Wrap in BaseLayout with title="Our Tours" and description="Explore South African adventure tours - overlanding, diving, rafting, camping and more with JaJa Tours"
4. Page structure:
   - `<section class="container tours-page">` wrapper
   - `<h1>Our Tours</h1>`
   - Intro paragraph: "Explore our range of South African adventures. From multi-day overlanding expeditions to diving experiences, find the tour that's right for you."
   - Tour grid div with class "tour-grid" containing TourCard for each tour
   - If no tours: show friendly message "No tours available yet. Check back soon!"

**Styling (scoped):**
- `.tours-page`: padding-top 2rem, padding-bottom 3rem
- `.tour-grid`: CSS grid, gap 2rem
  - Default (mobile): 1 column (`grid-template-columns: 1fr`)
  - 768px+: 2 columns (`repeat(2, 1fr)`)
  - 1024px+: 3 columns (`repeat(3, 1fr)`)
- `.tours-page h1`: margin-bottom 0.5rem
- Intro paragraph: margin-bottom 2rem, color var(--color-text-light), max-width 600px

Use mobile-first media queries with `min-width` (established pattern from Phase 1).
  </action>
  <verify>
Run `npm run build` to confirm the page builds. Check that src/pages/tours/index.astro exists. The page should be accessible at /tours in dev mode.
  </verify>
  <done>
/tours page renders a responsive grid of TourCard components fetched from Sanity. Mobile shows 1 column, tablet 2, desktop 3. Empty state handled gracefully. Build passes.
  </done>
</task>

</tasks>

<verification>
1. `npm run build` completes without errors
2. src/pages/tours/index.astro imports and uses allToursQuery, BaseLayout, TourCard
3. src/components/TourCard.astro imports urlForImage and renders card with image, title, excerpt, pricing, category, duration
4. Tour grid is responsive with mobile-first breakpoints
5. TourCard links to /tours/{slug}
</verification>

<success_criteria>
- /tours page exists and fetches all tours from Sanity via allToursQuery
- TourCard component displays image, title, excerpt, price, category, duration
- Cards link to /tours/{slug} for navigation to detail pages
- Responsive grid: 1 col mobile, 2 col tablet, 3 col desktop
- Build passes cleanly
</success_criteria>

<output>
After completion, create `.planning/phases/03-tour-content/03-02-SUMMARY.md`
</output>
